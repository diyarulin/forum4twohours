package main

import (
	"database/sql"
	"fmt"
	"log"

	_ "github.com/mattn/go-sqlite3"
)

type Posts struct {
	ID   int
	Name string
	Body string
	Date string
	User string
}

func main() {
	path := "./forum.db"
	db, err := sql.Open("sqlite3", path)
	if err != nil {
		panic(err)
	}

	defer db.Close()

	//Install data
	_, err = db.Exec(`
	    INSERT INTO Posts (ID, Name, Body, Date, User)
	    VALUES (4, 'Forum4twohours', 'How to make forum 4 2 hours', '2024-10-22', 'Dida')
	`)
	if err != nil {
		log.Fatalf("Error inserting data: %v", err)
	}

	// Выборка данных
	res, err := db.Query("SELECT * FROM Posts;")
	if err != nil {
		log.Fatalf("Error selecting data: %v", err)
	}
	for res.Next() {
		var post Posts
		// Укажите все поля структуры для сканирования данных
		err := res.Scan(&post.ID, &post.Name, &post.Body, &post.Date, &post.User)
		if err != nil {
			log.Fatalf("Error scanning data: %v", err)
		}
		// Вывод данных на экран
		fmt.Printf("PostID: %d, Name: %s, Body: %s, Date: %s, User: %s\n",
			post.ID, post.Name, post.Body, post.Date, post.User)
	}

}
